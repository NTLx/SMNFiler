<!--
 * @Author: Letmeouted
 * @Email: 1002726239@qq.com
 * @FilePath: \eapp-corp-projectc:\WebProject\SMNFiler\SMNFiler\index.html
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>SMNFiler</title>
    <script src="node_modules/mdui/dist/js/mdui.min.js"></script>
    <link rel="stylesheet" href="node_modules/mdui/dist/css/mdui.min.css" />
  </head>

  <body class="mdui-theme-primary-indigo mdui-bottom-nav-fixed">
    <div class="mdui-tab mdui-tab-centered mdui-tab-full-width" mdui-tab>
      <a
        href="#tab1"
        class="mdui-ripple mdui-tab-active"
        onmousedown="mOver1(this)"
      >
        <i id="tab1_icon" class="mdui-icon material-icons">&#xe24d;</i></a
      >
      <a href="#tab4" class="mdui-ripple" onmousedown="mOver4(this)">
       <i id="tab4_icon" class="mdui-icon material-icons">&#xe865;</i>
      </a>
      <a href="#tab2" class="mdui-ripple" onmousedown="mOver2(this)">
        <i id="tab2_icon" class="mdui-icon material-icons">&#xe8b8;</i></a
      >
      <a href="#tab3" class="mdui-ripple" onmousedown="mOver3(this)">
        <i id="tab3_icon" class="mdui-icon material-icons">&#xe616;</i>
      </a>
    </div>
    <div id="tab1" class="mdui-p-a-1">
      <div
        id="holder"
        class="mdui-valign mdui-hoverable mdui-ripple mdui-shadow-1 mdui-m-a-2 mdui-color-theme mdui-img-rounded"
        style="height: 240px"
      >
        <p class="mdui-center">
          <i class="mdui-icon material-icons">&#xe226;</i>文件处理区
        </p>
      </div>

      <div class="mdui-m-x-2 mdui-m-y-4">
        <button
          class="mdui-btn mdui-ripple mdui-color-orange mdui-btn-raised mdui-float-left"
          onclick="window.open('https://github.com/NTLx/SMNFiler')"
        >
          <i class="mdui-icon material-icons">&#xe8fd;</i>帮助
        </button>
        <div
          class="mdui-valign mdui-float-left"
          style="height: 15px; margin-left: 18px"
        >
          <p class="mdui-center">
            <br />注意：文件名当中不能含有空格、特殊符号、中文
          </p>
        </div>
        <button
          class="mdui-btn mdui-ripple mdui-color-teal mdui-btn-raised mdui-float-right"
          id="prompt"
          onclick="window.close()"
        >
          <i class="mdui-icon material-icons">&#xe879;</i>退出
        </button>
      </div>
    </div>
    <div id="tab4" class="mdui-p-a-1">
      <div style="overflow-y: auto;height: 80vh;">
        <button id="addUploadSample" class="mdui-btn mdui-ripple mdui-color-orange mdui-btn-raised">上传样本数据</button>
        <p style="text-align: center;font-weight: bold;">运动神经元存活基因拷贝数检验报告数据</p>
        <table border="1" id="tableContent" style="white-space: nowrap;text-align:center;">
            <tr width="100%">
                <th>序号</th>
                <th>姓名</th>
                <th>性别</th>
                <th>手机号</th>
                <th>简要病史</th>
                <th>采样日期</th>
                <th>检验日期</th>
                <th>报告日期</th>
                <th>检验单位</th>
                <th>样本类型</th>
                <th>检验者</th>
                <th>审核者</th>
                <th>SMN1外显子7</th>
                <th>SMN2外显子7</th>
                <th>检验结论</th>
            </tr>
        </table>
      </div>
    </div>
    <div id="tab2" class="mdui-p-a-3">
      <div class="mdui-valign mdui-col-xs-4 mdui-p-a-2 mdui-center">
        <label class="mdui-switch">
          <input id="change_chinese" type="checkbox" />
          <i class="mdui-switch-icon"></i>
          <span class="mdui-m-a-1">设置语言为中文</span>
        </label>
      </div>
      <div class="mdui-valign mdui-col-xs-4 mdui-p-a-2 mdui-center">
        <label class="mdui-switch">
          <input id="peak_area" type="checkbox" />
          <i class="mdui-switch-icon"></i>
          <span class="mdui-m-a-1">峰面积代替峰高</span>
        </label>
      </div>
      <!-- <div class="mdui-valign mdui-col-xs-6 mdui-p-a-2 mdui-center">
      <label class="mdui-switch">
        <input id="more_button" type="checkbox" />
        <i class="mdui-switch-icon"></i>
        <span class="mdui-m-a-1">更多计算结果</span>
      </label>
    </div>
    <div class="mdui-valign mdui-col-xs-6 mdui-p-a-2 mdui-center">
      <label class="mdui-switch">
        <input id="sample_order" type="checkbox" checked />
        <i class="mdui-switch-icon"></i>
        <span class="mdui-m-a-1">保持输入样本顺序</span>
      </label>
    </div> -->
      <!-- <div class="mdui-valign mdui-col-xs-6 mdui-p-a-2 mdui-center">
      <label class="mdui-switch">
        <input id="NTC_Test" type="checkbox" />
        <i class="mdui-switch-icon"></i>
        <span class="mdui-m-a-1">进行NTC测试</span>
      </label>
    </div> -->
      <div class="mdui-valign mdui-col-xs-4 mdui-p-a-2 mdui-center">
        <label class="mdui-switch">
          <button
            class="mdui-m-a-1 mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme"
            mdui-dialog="{target:'#dialog'}"
            id="customer"
          >
            自定义样本名
          </button>
        </label>
      </div>
      <div class="mdui-valgin mdui-col-xs-4 mdui-p-a-2 mdui-center">
        <label class="mdui-switch">
          <button
            class="mdui-m-a-1 mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme"
            mdui-dialog="{target:'#dialog_ntcTest'}"
            id="customer_ntcTest"
          >
            自定义NTC测试
          </button>
        </label>
      </div>
      <div class="mdui-valgin mdui-col-xs-4 mdui-p-a-2 mdui-center">
        <label class="mdui-switch">
          <button
            class="mdui-m-a-1 mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme"
            mdui-dialog="{target:'#dialog_ladderTest'}"
            id="customer_ladderTest"
          >
            自定义Ladder测试
          </button>
        </label>
      </div>
      <div class="mdui-valign mdui-p-a-3">
        <label>选择输出格式:</label>
      </div>
      <div class="mdui-valign" style="width: 140px; height: 40px">
        <form class="mdui-center mdui-p-a-1">
          <label class="mdui-radio mdui-center">
            <input id="utf" type="radio" name="group1" checked />
            <i class="mdui-radio-icon"></i>UTF-8
          </label>
          <label class="mdui-radio mdui-center">
            <input id="gbk" type="radio" name="group1" />
            <i class="mdui-radio-icon"></i>GBK
          </label>
        </form>
      </div>

      <div class="mdui-dialog" id="dialog">
        <div class="mdui-dialog-title">请自定义标准品样本名</div>
        <div class="mdui-dialog-content">
          <input type="text" name="sample" id="samples" />
        </div>
        <div class="mdui-dialog-actions">
          <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          <button class="mdui-btn mdui-ripple" mdui-dialog-confirm>确认</button>
        </div>
      </div>
      <div class="mdui-dialog" id="dialog_ntcTest">
        <div class="mdui-dialog-title">请自定义进行NTC检测的样本名</div>
        <div class="mdui-dialog-content">
          <input type="text" name="ntcTest" id="ntcTest" />
        </div>
        <div class="mdui-dialog-actions">
          <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          <button class="mdui-btn mdui-ripple" mdui-dialog-confirm>确认</button>
        </div>
      </div>
      <div class="mdui-dialog" id="dialog_ladderTest">
        <div class="mdui-dialog-title">请自定义进行Ladder检测的样本名</div>
        <div class="mdui-dialog-content">
          <input type="text" name="ladderTest" id="ladderTest" />
        </div>
        <div class="mdui-dialog-actions">
          <button class="mdui-btn mdui-ripple" mdui-dialog-cancel>取消</button>
          <button class="mdui-btn mdui-ripple" mdui-dialog-confirm>确认</button>
        </div>
      </div>
      <div class="mdui-valign mdui-p-a-1">
        <label>选择输出文件种类:</label>
      </div>
      <div class="mdui-valign" style="width: 680px; height: 40px">
        <form class="mdui-p-a-1">
          <label class="mdui-radio">
            <input id="dataFile" type="radio" name="group2" checked />
            <i class="mdui-radio-icon"></i>仅输出结果文件
          </label>
          <label class="mdui-radio">
            <input id="dataFileReport" type="radio" name="group2" />
            <i class="mdui-radio-icon"></i>输出结果文件和报告
          </label>
          <label class="mdui-radio">
            <input id="dataFilePictureReport" type="radio" name="group2" />
            <i class="mdui-radio-icon"></i>输出结果文件和包含图片报告
          </label>
        </form>
      </div>
      <div class="mdui-valign mdui-p-a-1">
        <label>以下设置只针对生成报告:</label>
      </div>
      <div class="mdui-valign  mdui-col-xs-6 mdui-p-a-1 mdui-center">
        <label class="mdui-switch mdui-center">
            <input id="outpdf" type="checkbox" />
            <i class="mdui-switch-icon"></i>
            <span class="mdui-m-a-1">生成HTML文件</span>
        </label>
    </div>
    <div class="mdui-valign mdui-col-xs-6 mdui-p-a-1 mdui-center">
        <label class="mdui-switch mdui-center">
            <input id="switchFont" type="checkbox" />
            <i class="mdui-switch-icon"></i>
            <span class="mdui-m-a-1">切换为MiSans字体(默认为宋体)</span>
        </label>
    </div>
    </div>
    <div id="tab3" class="mdui-p-a-1">
      <div class="layout">
        <!-- <div class="mdui-col-xs-12  panel">日志信息</div>
      <div id="restore" class="mdui-col-xs-12 result2"></div> -->
        <button
          onclick="up();"
          class="mdui-fab mdui-fab-mini mdui-fab-fixed mdui-ripple uptop"
        >
          <i class="mdui-icon material-icons">&#xe5d8;</i>
        </button>
        <button
          onclick="down();"
          class="mdui-fab mdui-fab-mini mdui-fab-fixed mdui-ripple"
        >
          <i class="mdui-icon material-icons">&#xe5db;</i>
        </button>
        <button
          onclick="download()"
          class="mdui-fab mdui-fab-mini mdui-fab-fixed mdui-ripple download"
        >
          <i class="mdui-icon material-icons">&#xe2c4;</i>
        </button>
        <!-- <i class="mdui-icon material-icons mdui-center">&#xe0d8;</i> -->
        <div id="test" style="overflow-y: auto; height: 90vh"></div>
      </div>
    </div>
    <script>
      var $ = mdui.$;
      var inst = new mdui.Dialog("#dialog");
      var sample_status = "STD";
      // method
      document
        .getElementById("customer")
        .addEventListener("click", function () {
          mdui.snackbar({ message: "自定义标准品样本名" });
          var dialog = document.getElementById("dialog");
          dialog.addEventListener("confirm.mdui.dialog", function () {
            console.log("confirm");
            sample_status1 = document.getElementById("samples").value;
            sample_status = sample_status1;
            console.log(sample_status);
          });
        });
      // NTCTest method
      var NTC_status = "";
      document
        .getElementById("customer_ntcTest")
        .addEventListener("click", function () {
          mdui.snackbar({ message: "自定义NTC测试" });
          var dialog1 = document.getElementById("dialog_ntcTest");
          dialog1.addEventListener("confirm.mdui.dialog", function () {
            console.log("confirm1");
            NTC_status1 = document.getElementById("ntcTest").value;
            if (NTC_status1 == "") {
              NTC_status = "";
            } else {
              NTC_status = NTC_status1;
            }
          });
        });
      var ladder_status = "";
      document
        .getElementById("customer_ladderTest")
        .addEventListener("click", function () {
          mdui.snackbar({ message: "自定义Ladder测试" });
          var dialog1 = document.getElementById("dialog_ladderTest");
          dialog1.addEventListener("confirm.mdui.dialog", function () {
            console.log("confirm1");
            ladder_status1 = document.getElementById("ladderTest").value;
            if (ladder_status1 == "") {
              ladder_status = "";
            } else {
              ladder_status = ladder_status1;
            }
          });
        });
      var Chinese = "";
      var language = function () {
        if ($("#change_chinese").is(":checked")) {
          console.log("Language is Chinese");
          mdui.snackbar({ message: "设置语言为中文" });
          Chinese = "-l";
        } else {
          console.log("Language is English");
          mdui.snackbar({ message: "设置语言为英语" });
          Chinese = "";
        }
      };
      // var more = "";
      // var more_status = function () {
      //   if ($("#more_button").is(":checked")) {
      //     console.log("more Calculation results");
      //     mdui.snackbar({ message: "输出显示更多计算结果" });
      //     more = "-v";
      //   } else {
      //     console.log("not more Calculation results");
      //     mdui.snackbar({ message: "无更多计算结果" });
      //     more = "";
      //   }
      // };
      var peak = "";
      var peak_status = function () {
        if ($("#peak_area").is(":checked")) {
          console.log("peak area");
          mdui.snackbar({ message: "峰面积代替峰高" });
          peak = "-a";
        } else {
          console.log("peak height");
          mdui.snackbar({ message: "峰高" });
          peak = "";
        }
      };

      // var order = "-k";
      // var samplename_order = function () {
      //   if ($("#sample_order").is(":checked")) {
      //     console.log("sample_order");
      //     mdui.snackbar({ message: "保持样本输入顺序" });
      //     order = "-k";
      //   } else {
      //     console.log("not sample_order");
      //     mdui.snackbar({ message: "不保持样本输入顺序" });
      //     order = "";
      //   }
      // };
      var Encoding = "UTF-8";
      var encod_status = function () {
        if ($("#gbk").is(":checked")) {
          console.log("Output set GBK Encode");
          mdui.snackbar({ message: "输出文件将以 GBK 格式编码" });
          Encoding = "GBK";
          Chinese = "-l";
        }
        if ($("#utf").is(":checked")) {
          console.log("Output set UTF-8 Encode");
          mdui.snackbar({ message: "输出文件将以 UTF-8 格式编码" });
          Encoding = "UTF-8";
        }
      };
      var includePicture = ""
      var noPicture = 0
      var pictureStatus = function(){
        if($("#dataFile").is(":checked")){
          mdui.snackbar({message:"输出文件结果文件"})
          includePicture = ""
          noPicture =0
        }
        if($("#dataFileReport").is(":checked")){
          mdui.snackbar({message:"输出结果文件和报告"})
          includePicture = ""
          noPicture = 1
        }
        if($("#dataFilePictureReport").is(":checked")){
          mdui.snackbar({message:"输出结果文件和包含图片报告"})
          includePicture = "-f"
          noPicture = 1
        }
      }
      
var switch_status = 0;
        var font_status = 0;
        var outpdf_status = function () {
            if ($("#outpdf").is(":checked")) {
                console.log("generate HTML file is on")
                mdui.snackbar({
                    message: "开启生成HTML文件"
                })
                switch_status = 1
                console.log(switch_status)
            } else {
                console.log("generate HTML file is off")
                mdui.snackbar({
                    message: "关闭生成HTML文件"
                })
                switch_status = 0
                console.log(switch_status)
            }
        }
        var switchFont_status = function () {
            if ($("#switchFont").is(":checked")) {
                console.log("切换网页报告字体为 MiSans")
                mdui.snackbar({
                    message: "网页报告字体为 MiSans"
                })
                font_status = 1
                console.log(font_status)
            } else {
                console.log("切换网页报告字体为宋体")
                mdui.snackbar({
                    message: "网页报告字体为宋体"
                })
                font_status = 0
                console.log(font_status)
            }
        }
    $("#outpdf").on("click", outpdf_status)
      $("#switchFont").on("click", switchFont_status)

      $("#utf").on("click", encod_status);
      $("#gbk").on("click", encod_status);
      $("#dataFile").on("click",pictureStatus)
      $("#dataFileReport").on("click",pictureStatus)
      $("#dataFilePictureReport").on("click",pictureStatus)
      // $("#NTC_Test").on("click",NTC_status);
      // $("#more_button").on("click", more_status);
      $("#peak_area").on("click", peak_status);
      $("#change_chinese").on("click", language);
      // $("#sample_order").on("click", samplename_order)
      function mOver1(obj) {
        mdui.snackbar({ message: "进入分析面板", timeout: 1000 });
      }
      function mOver4(obj) {
        mdui.snackbar({ message:"进入出报告面板", timeout:1000})
      }
      function mOver2(obj) {
        mdui.snackbar({ message: "进入设置面板", timeout: 1000 });
      }
      function mOver3(obj) {
        mdui.snackbar({ message: "进入日志面板", timeout: 1000 });
      }
      var path = require("path");
      var log = require("electron-log");
      log.transports.console.level = "silly";
      var { remote } = require("electron");
      var fs = require("fs");
      var app = remote.app;
      var filepath = path.join(app.getPath("temp"));
      console.log(filepath);
      var filename = "SMNFiler.log";
      log.transports.file.resolvePath = () => path.join(filepath, filename);
      console.log(log.transports.file.resolvePath);
      var exec = require("child_process").execFile;
      var dataAddress = []
      var dataAddress1 = []
      // function start(file_path, Encoding, sample_status, peak, more, Chinese, order) {}
      function start(
        file_path,
        Encoding,
        sample_status,
        peak,
        Chinese,
        NTC_status,
        ladder_status,
        includePicture
      ) {
        
        // fileArrayPath.push(file_path[0])
        // fileArrayPath.push(file_path[0])
        // console.log("121212",fileArrayPath)
        console.log("Request handler 'start' was called.");
        if (file_path.constructor === Array) {
          file_name = file_path[0].trim();
          fileName = file_name.substring(file_name.lastIndexOf("\\") + 1);
         
        } else {
          file_name = file_path.trim();
          fileName = file_name.substring(file_name.lastIndexOf("\\") + 1);
        }
        var exe_file;
        if (process.platform === "darwin") {
          exe_file = path.join(__dirname, "analysis.mac");
        }
        if (process.platform === "win32") {
          exe_file = path.join(__dirname, "analysis_miss.exe");
        }
        if (process.platform === "linux") {
          exe_file = path.join(__dirname, "analysis_miss");
        }
        if (NTC_status == "" && ladder_status == "") {
          exec(
            exe_file,
            [
              "-i",
              file_path,
              "-e",
              Encoding,
              "-c",
              sample_status,
              peak,
              Chinese,
              NTC_status,
              ladder_status,
              includePicture
            ],
            function (error, stdout, stderr) {
              console.log(
                "-i",
                file_path,
                "-e",
                Encoding,
                "-c",
                sample_status,
                peak,
                Chinese,
                NTC_status,
                ladder_status,
                includePicture
              );
              console.log("stdout", stdout);
              console.log("stderr", stderr);
              if (error || stderr) {
                var notice = "[WARNING] 输入文件 " + file_path + " 处理有误";
                mdui.snackbar({
                  message: notice,
                  position: "left-top",
                  onClick: function () {
                    ipc.send("tab3");
                  },
                });
                console.warn("stderr:\n" + stderr);
                log.warn(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n报错提示：\n" +
                    stderr
                );
                if (error !== null) {
                  log.error(
                    "\n" +
                      "当前处理文件名为：" +
                      fileName +
                      "\n错误提示：\n" +
                      error
                  );
                }
                // if(document.getElementById('restore').innerHTML === '<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }
                // document.getElementById('restore').innerHTML = '<br/>' + "<b style='color:#da242a'>当前处理文件名：</b>" + fileName + '<br/>'
              } else if (stdout) {
                setTimeout(function () {
                  var notice = "输入文件 " + file_path + " 处理完成";
                  mdui.snackbar({ message: notice });
                }, 1000);
                // if(document.getElementById('restore').innerHTML ==='<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }

                log.info(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n处理文件耗时：\n" +
                    stdout
                );
                if(includePicture==""&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else if(includePicture=="-f"&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else{
                  
                }
              }
            }
          );
        } else if (NTC_status != "" && ladder_status != "") {
          exec(
            exe_file,
            [
              "-i",
              file_path,
              "-e",
              Encoding,
              "-c",
              sample_status,
              peak,
              Chinese,
              "-n",
              NTC_status,
              "-d",
              ladder_status,
              includePicture
            ],
            function (error, stdout, stderr) {
              console.log(
                "-i",
                file_path,
                "-e",
                Encoding,
                "-c",
                sample_status,
                peak,
                Chinese,
                "-n",
                NTC_status,
                "-d",
                ladder_status,
                includePicture
              );
              console.log("stdout", stdout);
              console.log("stderr", stderr);
              if (error || stderr) {
                var notice = "[WARNING] 输入文件 " + file_path + " 处理有误";
                mdui.snackbar({
                  message: notice,
                  position: "left-top",
                  onClick: function () {
                    ipc.send("tab3");
                  },
                });
                console.warn("stderr:\n" + stderr);
                log.warn(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n报错提示：\n" +
                    stderr
                );
                if (error !== null) {
                  log.error(
                    "\n" +
                      "当前处理文件名为：" +
                      fileName +
                      "\n错误提示：\n" +
                      error
                  );
                }
                // if(document.getElementById('restore').innerHTML === '<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }
                // document.getElementById('restore').innerHTML = '<br/>' + "<b style='color:#da242a'>当前处理文件名：</b>" 
              } else if (stdout) {
                setTimeout(function () {
                  var notice = "输入文件 " + file_path + " 处理完成";
                  mdui.snackbar({ message: notice });
                }, 1000);
                // if(document.getElementById('restore').innerHTML ==='<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }

                log.info(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n处理文件耗时：\n" +
                    stdout
                );
                if(includePicture==""&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else if(includePicture=="-f"&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else{
                  
                }
              }
            }
          );
        } else if (NTC_status != "" && ladder_status == "") {
          exec(
            exe_file,
            [
              "-i",
              file_path,
              "-e",
              Encoding,
              "-c",
              sample_status,
              peak,
              Chinese,
              "-n",
              NTC_status,
              ladder_status,
              includePicture
            ],
            function (error, stdout, stderr) {
              console.log(
                "-i",
                file_path,
                "-e",
                Encoding,
                "-c",
                sample_status,
                peak,
                Chinese,
                "-n",
                NTC_status,
                ladder_status,
                includePicture
              );
              console.log("stdout", stdout);
              console.log("stderr", stderr);
              if (error || stderr) {
                var notice = "[WARNING] 输入文件 " + file_path + " 处理有误";
                mdui.snackbar({
                  message: notice,
                  position: "left-top",
                  onClick: function () {
                    ipc.send("tab3");
                  },
                });
                console.warn("stderr:\n" + stderr);
                log.warn(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n报错提示：\n" +
                    stderr
                );
                if (error !== null) {
                  log.error(
                    "\n" +
                      "当前处理文件名为：" +
                      fileName +
                      "\n错误提示：\n" +
                      error
                  );
                }
                // if(document.getElementById('restore').innerHTML === '<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }
                // document.getElementById('restore').innerHTML = '<br/>' + "<b style='color:#da242a'>当前处理文件名：</b>" + fileName + '<br/>'
              } else if (stdout) {
                setTimeout(function () {
                  var notice = "输入文件 " + file_path + " 处理完成";
                  mdui.snackbar({ message: notice });
                }, 1000);
                // if(document.getElementById('restore').innerHTML ==='<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }

                log.info(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n处理文件耗时：\n" +
                    stdout
                );
                if(includePicture==""&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else if(includePicture=="-f"&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else{
                  
                }
              }
            }
          );
        } else {
          exec(
            exe_file,
            [
              "-i",
              file_path,
              "-e",
              Encoding,
              "-c",
              sample_status,
              peak,
              Chinese,
              NTC_status,
              "-d",
              ladder_status,
              includePicture
            ],
            function (error, stdout, stderr) {
              console.log(
                "-i",
                file_path,
                "-e",
                Encoding,
                "-c",
                sample_status,
                peak,
                Chinese,
                NTC_status,
                "-d",
                ladder_status,
                includePicture
              );
              console.log("stdout", stdout);
              console.log("stderr", stderr);
              if (error || stderr) {
                var notice = "[WARNING] 输入文件 " + file_path + " 处理有误";
                mdui.snackbar({
                  message: notice,
                  position: "left-top",
                  onClick: function () {
                    ipc.send("tab3");
                  },
                });
                console.warn("stderr:\n" + stderr);
                log.warn(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n报错提示：\n" +
                    stderr
                );
                if (error !== null) {
                  log.error(
                    "\n" +
                      "当前处理文件名为：" +
                      fileName +
                      "\n错误提示：\n" +
                      error
                  );
                }
                // if(document.getElementById('restore').innerHTML === '<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }
                // document.getElementById('restore').innerHTML = '<br/>' + "<b style='color:#da242a'>当前处理文件名：</b>" + fileName + '<br/>'
              } else if (stdout) {
                setTimeout(function () {
                  var notice = "输入文件 " + file_path + " 处理完成";
                  mdui.snackbar({ message: notice });
                }, 1000);
                // if(document.getElementById('restore').innerHTML ==='<p style="text-align:center">所有日志信息全部位于程序运行日志窗口中</p>'){
                // 	document.getElementById('restore').innerHTML =""
                // }

                log.info(
                  "\n" +
                    "当前处理文件名为：" +
                    fileName +
                    "\n处理文件耗时：\n" +
                    stdout
                );
                if(includePicture==""&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else if(includePicture=="-f"&&noPicture==1){
                  const tab4 = document.querySelector("#tab4_icon")
                  tab4.click()
                }else{
                  
                }
              }
            }
          );
        }

        
      }
      // console.log("fileArrayPath",fileArrayPath)
      // child_process.spawn method
      // var path = require("path");

      // function start(file_path, Encoding, sample_status, peak, more, Chinese, order) {
      //   console.log("Request handler 'start' was called.");
      //   console.log(file_path)
      //   if (file_path.constructor === Array) {
      //     file_name = file_path[0].trim()
      //     fileName = file_name.substring(file_name.lastIndexOf('\\') + 1)
      //   } else {
      //     file_name = file_path.trim()
      //     fileName = file_name.substring(file_name.lastIndexOf('\\') + 1)
      //   }
      //   const { spawn } = require("child_process");
      //   var exe_file;
      //   if (process.platform === "darwin") {
      //     exe_file = path.join(__dirname, "analysis.mac");
      //   }
      //   if (process.platform === "win32") {
      //     exe_file = path.join(__dirname, "analysis.exe");
      //   }
      //   var childProcess = spawn(exe_file, [
      //     "-i",
      //     file_path,
      //     "-e",
      //     Encoding,
      //     "-c",
      //     sample_status,
      //     peak,
      //     more,
      //     Chinese,
      //     order
      //   ]);
      //   childProcess.stderr.on("data", (data) => {
      //     console.log(`stderr: ${data}`);
      //     var notice = "[WARNING] 输入文件 " + file_path + " 处理有误";
      //     mdui.snackbar({ message: notice, position: "left-top" });
      //     document.getElementById('restderr').innerHTML += "*******************************" + "<br/>" + "当前处理文件名：" + fileName + '<br/>'+ "错误提示信息：" + data + '<br/>' + '*******************************' + '<br/>'
      //    document.getElementById('restore').innerHTML += "*******************************" + "<br/>" + "当前处理文件名：" + fileName + '<br/>' + '*******************************' + '<br/>'
      //   });
      //   childProcess.stdout.on("data", (data) => {
      //     console.log(`stdout: ${data}`);
      //     setTimeout(function () {
      //       var notice = "输入文件 " + file_path + " 处理完成";
      //       mdui.snackbar({ message: notice });
      //     }, 5000)
      //   document.getElementById('restore').innerHTML +="*******************************" + "<br/>" + "当前处理文件名：" + fileName + '<br/>' + "处理文件耗时：" + data + '<br/>' + '*******************************' + '<br/>'
      //     console.log(
      //       "-i",
      //       file_path,
      //       "-e",
      //       Encoding,
      //       "-c",
      //       sample_status,
      //       peak,
      //       more,
      //       Chinese,
      //       order
      //     );
      //   });
      //   childProcess.on("close", (code) => {
      //     console.log(`子进程退出码：${code}`);
      //   });
      // }
      //function:upload sample file to deal report
      function sampleFileStart(file_path1){
        // var resultFilePath = start(file_path,Encoding,sample_status,peak,Chinese,NTC_status,ladder_status);
        // console.log("resultFilePath",resultFilePath)
        var path = require("path")
        console.log("dataAddress1",dataAddress1[0])
        var copyFileName = dataAddress1[0].substring(dataAddress1[0].lastIndexOf('\\') + 1)
        var copyFilePath = dataAddress1[0].substring(0,dataAddress1[0].lastIndexOf("\\") + 1)
        var copyRemoveFileTxt = copyFileName.substring(0,copyFileName.indexOf("."))
        console.log("copyFileName",copyFileName)
        console.log("copyFilePath",copyFilePath)
        console.log("copyRemoveFileTxt",copyRemoveFileTxt)
        var nowDate = new Date()
        var nowDateStr = nowDate.getFullYear()+"_"+(nowDate.getMonth()+1)+"_"+nowDate.getDate()
        console.log("nowDateStr",nowDateStr)
        var figureFileUrl = path.join(copyFilePath,copyRemoveFileTxt+"."+nowDateStr,copyRemoveFileTxt+"."+nowDateStr+"."+Encoding+".figure.tsv")
        console.log("figureFileUrl",figureFileUrl)
        console.log("file_path1.constructor",file_path1.constructor)
        sampleFileNamePath =file_path1[0].trim()
        console.log(sampleFileNamePath)
        sampleFileName = sampleFileNamePath.substring(sampleFileNamePath.lastIndexOf("\\")+1)
        console.log("sampleFileName",sampleFileName)
        sampleFileNameCurrentPath = sampleFileNamePath.substring(0,sampleFileNamePath.lastIndexOf("\\")+1)
        console.log("sampleFileNameCurrentPath",sampleFileNameCurrentPath)
        log.info("\n"+"当前处理文件名："+sampleFileName+"\n"+"成功传入输入样本数据文件")
        var fs = require("fs")
        var xlsx = require("node-xlsx")
        var sampleSheets = xlsx.parse(file_path1[0])
        var sampleSheetsData = sampleSheets[0].data
        var sampleLineData = []
        var newSampleLineData = []
        if(includePicture == "-f"){
          var figureSheets = xlsx.parse(figureFileUrl)
          var figureSheetsData = figureSheets[0].data
          var figureLineData = []
          var newFigureLineData = []
          for(var k=1;k<figureSheetsData.length;k++){
            figureLineData.push(figureSheetsData[k])
          }
        }
        for(var j=1;j<sampleSheetsData.length;j++){
          sampleLineData.push(sampleSheetsData[j])
          console.log("sampleLineData",sampleLineData)
        }
        
        
        var htmlName =[]
        var pdfName = []
        var newFolderName = []
        var folderName = []
        var pdfPathAndName = []
        var content = []
        var htmlPathAndName = []
        var displaySampleData = document.getElementById("tableContent")
        displaySampleData.innerHTML=`<tr width="100%">
                    <th>序号</th>
                    <th>姓名</th>
                    <th>性别</th>
                    <th>手机号</th>
                    <th>简要病史</th>
                    <th>采样日期</th>
                    <th>检验日期</th>
                    <th>报告日期</th>
                    <th>检验单位</th>
                    <th>样本类型</th>
                    <th>检验者</th>
                    <th>审核者</th>
                    <th>SMN1外显子7</th>
                    <th>SMN2外显子7</th>
                    <th>检验结论</th>
                </tr>`
            sampleLineData.forEach(function(item,index){
              var leftSlash = '/'
              if (sampleLineData[index][2] == ' ' || sampleLineData[index][2] == undefined) {
                  sampleLineData[index][2] = leftSlash
              }
              if (sampleLineData[index][3] == ' ' || sampleLineData[index][3] == undefined) {
                  sampleLineData[index][3] = leftSlash
              }
              if (sampleLineData[index][4] == ' ' || sampleLineData[index][4] == undefined) {
                  sampleLineData[index][4] = leftSlash
              }
              if (sampleLineData[index][7] == ' ' || sampleLineData[index][7] == undefined) {
                  sampleLineData[index][7] = leftSlash
              }
              if (sampleLineData[index][8] == ' ' || sampleLineData[index][8] == undefined) {
                  sampleLineData[index][8] = leftSlash
              }
              if (sampleLineData[index][12] == '/' || sampleLineData[index][12] == undefined) {
                  sampleLineData[index][12] = ''
              }
              if (sampleLineData[index][14] == ' ' || sampleLineData[index][14] == undefined) {
                  sampleLineData[index][14] = leftSlash
              }
              if (sampleLineData[index][15] == ' ' || sampleLineData[index][15] == undefined) {
                  sampleLineData[index][15] = leftSlash
              }
              displaySampleData.innerHTML += "<tr><td>" + sampleLineData[index][0] + "</td><td>" + sampleLineData[index][1] + "</td><td>" + sampleLineData[index][2] + "</td><td>" + sampleLineData[index][5] + "</td><td>" + sampleLineData[index][8] + "</td><td>" + sampleLineData[index][9] + "</td><td>" + sampleLineData[index][10] + "</td><td>" + sampleLineData[index][11] + "</td><td>" + sampleLineData[index][12] + "</td><td>" + sampleLineData[index][13] + "</td><td>" + sampleLineData[index][14] + "</td><td>" + sampleLineData[index][15] + "</td><td>" + sampleLineData[index][16] + "</td><td>" + sampleLineData[index][17] + "</td><td>" + sampleLineData[index][18] + "</td></tr>"
              //return report
              htmlName[index] = sampleLineData[index][0].substring(0,sampleLineData[index][0].indexOf("."))+ ".html"
              pdfName[index] = sampleLineData[index][0].substring(0,sampleLineData[index][0].indexOf(".")) + ".pdf";
              folderName[index] = sampleLineData[index][0].substring(0,sampleLineData[index][0].indexOf("."));
              newFolderName[index] = path.join(copyFilePath,copyRemoveFileTxt + "." + nowDateStr,folderName[index]);
              fs.mkdirSync(newFolderName[index]);
              htmlPathAndName[index] = path.join(newFolderName[index],htmlName[index]);
              pdfPathAndName[index] = path.join(newFolderName[index],pdfName[index]);
              console.log("pdfPathAndName",pdfPathAndName)
               //根据SMN1外显子7数值判断检验结论状态值
               if (sampleLineData[index][16] >= 2) {
                        var reportResult = "未检出目标基因拷贝数异常"
               } else if (sampleLineData[index][16] == 1) {
                   var reportResult = "SMN1基因外显子7杂合型缺失"
               } else if (sampleLineData[index][16] == 0) {
                   var reportResult = "SMN1基因外显子7纯合型缺失"
               }
               if(includePicture == "-f"){
                var echartsPath = path.join(__dirname,"../echarts.js")
                console.log("echartsPath",echartsPath)
                 var pictureHtml=`<tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>检验结果图谱</b></p>
                </td>
                <td width=339 colspan=12 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                  <div id="main" style="height: 306px; width: 460px"></div>
                </td>
            </tr>`
            var pagingTable = ` </td>
            </tr>
        </table>
        <table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=556
                                                 style='width:416.7pt;border-collapse:collapse;border:none;margin: auto;'>
            <tr>
                <td width=556 colspan=13 valign=middle style='width:416.7pt;border:solid windowtext 1.0pt;border:none;padding:0cm 5.4pt 0cm 0pt'>
                                                         <span style='font-size:10.5pt'>
                                                            <br clear=all style='page-break-before:always'>
                                                         </span>
                                                     </td>
            </tr>
        </table>
        <table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=556 id="mainContent"
        style='width:416.7pt;margin: auto;border-collapse:collapse;margin-top:40px;'>
            <tr>
                <td width=556 colspan=13 valign=middle style='width:416.7pt;
                padding:0cm 5.4pt 0cm 5.4pt'>`
          var pagingEnd = `</td>`
            var pictureScript=`<script type="text/javascript">
      /* 基于准备好的dom，初始化echarts实例*/
      var lastData = ${figureLineData[index][11]};
      if (lastData == false) {
        var mainContent = document.getElementById("main");
        var myChart = echarts.init(mainContent);
        var SMN1 = "${figureLineData[index][1]}";
        var SMN2 = "${figureLineData[index][2]}";
        var S01 = "${figureLineData[index][6]}";
        var S02 = "${figureLineData[index][9]}";
        var S03 = "${figureLineData[index][10]}";
        var S04 = "${figureLineData[index][4]}";
        var S05 = "${figureLineData[index][7]}";
        var S06 = "${figureLineData[index][3]}";
        var S07 = "${figureLineData[index][5]}";
        var S08 = "${figureLineData[index][8]}";
        if (S01 == "1 2") {
          var marker1Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker1Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S01 == "1") {
          var marker1Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker1Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S01 == "2") {
          var marker1Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker1Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S02 == "1 2") {
          var marker2Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker2Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S02 == "1") {
          var marker2Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker2Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S02 == "2") {
          var marker2Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker2Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S03 == "1 2") {
          var marker3Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker3Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S03 == "1") {
          var marker3Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker3Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S03 == "2") {
          var marker3Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker3Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S04 == "1 2") {
          var marker4Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 0,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "1") {
          var marker4Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 0,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "2") {
          var marker4Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 0,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "2 3") {
          var marker4Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 1,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "1 3") {
          var marker4Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 1,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "3") {
          var marker4Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 2,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        }
        if (S05 == "1 2") {
          var marker5Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker5Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S05 == "1") {
          var marker5Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker5Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S05 == "2") {
          var marker5Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker5Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S06 == "1 2") {
          var marker6Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker6Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S06 == "1") {
          var marker6Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker6Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S06 == "2") {
          var marker6Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*黄色*/
            },
          };
          var marker6Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S07 == "1 2") {
          var marker7Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker7Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S07 == "1") {
          var marker7Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker7Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S07 == "2") {
          var marker7Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker7Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S08 == "11 13") {
          var marker8Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker8Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S08 == "11") {
          var marker8Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker8Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S08 == "13") {
          var marker8Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker8Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else {
          var marker8Value1 = {
            value: 0,
            itemStyle: {
              color: "#00FFFF", /*青色*/
            },
          };
          var marker8Value2 = {
            value: 2,
            itemStyle: {
              color: "#00FFFF", /*青色*/
            },
          };
        }
        if (SMN1 > 1) {
          var SMN1Value1 = {
            value: SMN1,
            itemStyle: {
              color: "#9955FF", /*淡紫色*/
            },
          };
          var SMN1Value2 = {
            value: 0,
            itemStyle: {
              color: "#FF8888", /*淡红色*/
            },
          };
        } else {
          var SMN1Value1 = {
            value: 0,
            itemStyle: {
              color: "#9955FF", /*淡紫色*/
            },
          };
          var SMN1Value2 = {
            value: SMN1,
            itemStyle: {
              color: "#FF8888", /*淡红色*/
            },
          };
        }
        if (SMN2 >= 0) {
          var SMN2Value1 = {
            value: SMN2,
            itemStyle: {
              color: "#9955FF", //淡紫色
            },
          };
          var SMN2Value2 = {
            value: 0,
            itemStyle: {
              color: "#FF8888", //淡红色
            },
          };
        } 
        var option1 = {
          color: ["#9955FF", "#FF8888","#000088", "#FFFF00", "#FFC0CB" ],
          title: {
            text: "",
          },
          animation : false,
          aria: {
            enabled: true,
            decal: {
              show: true,
            },
          },
          tooltip: {
            trigger: "axis",
            axisPointer: {
              type: "shadow",
              label: {},
            },
          },
          grid:{top:"24%"},
          legend: {
            data: [
              
              {
                name: "SMN1>1,SMN2>=0",
                icon: "rect",

              },
              {
                name: "SMN1<=1",
                icon: "rect",
   
              },
              {
                name: "等位基因1",
                icon: "rect",

              },
              {
                name: "等位基因2",
                icon: "rect",

              },
              {
                name: "等位基因3",
                icon: "rect",

              },
            ],
          },
          xAxis: {
            data: [
              "SMN1",
              "SMN2",
              "S06",
              "S04",
              "S07",
              "S01",
              "S05",
              "S08",
              "S02",
              "S03",
            ],
            axisLabel: { interval: 0 },
          },
          yAxis: [
            {
              type: "value",
              name: "拷贝数",
              position: "left",
              alignTicks: true,
              axisLine: {
                show: true,
              },
              axisLabel: {
                formatter: "{value}",
              },
              interval: 1,
            },

          ],
          series: [
          {
              name: "SMN1>1,SMN2>=0",
              type: "bar",
              data: [SMN1Value1, SMN2Value1, 0, 0, 0, 0, 0, 0, 0, 0],
              barGap: "0%",
            },
            {
              name: "SMN1<=1",
              type: "bar",
              data: [SMN1Value2, SMN2Value2, 0, 0, 0, 0, 0, 0, 0, 0],
              barGap: "0%",

            },
            {
              name: "等位基因1",
              type: "bar",
              data: [
                0,
                0,
                marker6Value1,
                marker4Value1,
                marker7Value1,
                marker1Value1,
                marker5Value1,
                marker8Value1,
                marker2Value1,
                marker3Value1,
              ],
              barGap: "0%",
          
            },
            {
              name: "等位基因2",
              type: "bar",
              data: [
                0,
                0,
                marker6Value2,
                marker4Value2,
                marker7Value2,
                marker1Value2,
                marker5Value2,
                marker8Value2,
                marker2Value2,
                marker3Value2,
              ],
              barGap: "0%",
            },
            {
              name: "等位基因3",
              type: "bar",
              data: [0, 0, 0, marker4Value3, 0, 0, 0, 0, 0, 0],
              barGap: "0%",
            },
            
          ],
        };
        myChart.setOption(option1);
      } else {
        var mainContent = document.getElementById("main");
        var myChart = echarts.init(mainContent);
        var SMN1 = "${figureLineData[index][1]}";
        var SMN2 = "${figureLineData[index][2]}";
        var S01 = "${figureLineData[index][6]}";
        var S02 = "${figureLineData[index][9]}";
        var S03 = "${figureLineData[index][10]}";
        var S04 = "${figureLineData[index][4]}";
        var S05 = "${figureLineData[index][7]}";
        var S06 = "${figureLineData[index][3]}";
        var S07 = "${figureLineData[index][5]}";
        var S08 = "${figureLineData[index][8]}";
        if (S01 == "1 2") {
          var marker1Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker1Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S01 == "1") {
          var marker1Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker1Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S01 == "2") {
          var marker1Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker1Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S02 == "1 2") {
          var marker2Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker2Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S02 == "1") {
          var marker2Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker2Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S02 == "2") {
          var marker2Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker2Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S03 == "1 2") {
          var marker3Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker3Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S03 == "1") {
          var marker3Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker3Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S03 == "2") {
          var marker3Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker3Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S04 == "1 2") {
          var marker4Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 0,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "1") {
          var marker4Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 0,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "2") {
          var marker4Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 0,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "2 3") {
          var marker4Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 1,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "1 3") {
          var marker4Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 1,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        } else if (S04 == "3") {
          var marker4Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker4Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
          var marker4Value3 = {
            value: 2,
            itemStyle: {
              color: "#FFC0CB", /*粉色*/
            },
          };
        }
        if (S05 == "1 2") {
          var marker5Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker5Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S05 == "1") {
          var marker5Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker5Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S05 == "2") {
          var marker5Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker5Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S06 == "1 2") {
          var marker6Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker6Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S06 == "1") {
          var marker6Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker6Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S06 == "2") {
          var marker6Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*黄色*/
            },
          };
          var marker6Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S07 == "1 2") {
          var marker7Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker7Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S07 == "1") {
          var marker7Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker7Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S07 == "2") {
          var marker7Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker7Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        }
        if (S08 == "11 13") {
          var marker8Value1 = {
            value: 1,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker8Value2 = {
            value: 1,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S08 == "11") {
          var marker8Value1 = {
            value: 2,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker8Value2 = {
            value: 0,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else if (S08 == "13") {
          var marker8Value1 = {
            value: 0,
            itemStyle: {
              color: "#000088", /*深蓝色*/
            },
          };
          var marker8Value2 = {
            value: 2,
            itemStyle: {
              color: "#FFFF00", /*黄色*/
            },
          };
        } else {
          var marker8Value1 = {
            value: 0,
            itemStyle: {
              color: "#00FFFF", /*青色*/
            },
          };
          var marker8Value2 = {
            value: 2,
            itemStyle: {
              color: "#00FFFF", /*青色*/
            },
          };
        }
        if (SMN1 > 1) {
          var SMN1Value1 = {
            value: SMN1,
            itemStyle: {
              color: "#9955FF", /*淡紫色*/
            },
          };
          var SMN1Value2 = {
            value: 0,
            itemStyle: {
              color: "#FF8888", /*淡红色*/
            },
          };
        } else {
          var SMN1Value1 = {
            value: 0,
            itemStyle: {
              color: "#9955FF", /*淡紫色*/
            },
          };
          var SMN1Value2 = {
            value: SMN1,
            itemStyle: {
              color: "#FF8888", /*淡红色*/
            },
          };
        }
        if (SMN2 >= 0) {
          var SMN2Value1 = {
            value: SMN2,
            itemStyle: {
              color: "#9955FF", //淡紫色
            },
          };
          var SMN2Value2 = {
            value: 0,
            itemStyle: {
              color: "#FF8888", //淡红色
            },
          };
        }
        var option1 = {
          color: ["#9955FF", "#FF8888","#000088", "#FFFF00", "#FFC0CB" ],
          title: {
            text: "",
          },
          animation : false,
          aria: {
            enabled: true,
            decal: {
              show: true,
            },
          },
          tooltip: {
            trigger: "axis",
            axisPointer: {
              type: "shadow",
              label: {},
            },
          },
          grid:{top:"24%"},
          legend: {
            data: [
              
              {
                name: "SMN1>1,SMN2>=0",
                icon: "rect",
              },
              {
                name: "SMN1<=1",
                icon: "rect",
                
              },
              {
                name: "等位基因1",
                icon: "rect",
                
              },
              {
                name: "等位基因2",
                icon: "rect",
                
              },
              {
                name: "等位基因3",
                icon: "rect",
                
              },
            ],
          },
          xAxis: {
            data: [
              "SMN1",
              "SMN2",
              "S06",
              "S04",
              "S07",
              "S01",
              "S05",
              "S08",
              "S02",
              "S03",
            ],
            axisLabel: { interval: 0 },
          },
          yAxis: [
            {
              type: "value",
              name: "拷贝数",
              position: "left",
              alignTicks: true,
              axisLine: {
                show: true,
              },
              axisLabel: {
                formatter: "{value}",
              },
              interval: 1,
            },

          ],
          series: [
          {
              name: "SMN1>1,SMN2>=0",
              type: "bar",
              data: [SMN1Value1, SMN2Value1, 0, 0, 0, 0, 0, 0, 0, 0],
              barGap: "0%",
            },
            {
              name: "SMN1<=1",
              type: "bar",
              data: [SMN1Value2, SMN2Value2, 0, 0, 0, 0, 0, 0, 0, 0],
              barGap: "0%",

            },
            {
              name: "等位基因1",
              type: "bar",
              data: [
                0,
                0,
                marker6Value1,
                marker4Value1,
                marker7Value1,
                marker1Value1,
                marker5Value1,
                marker8Value1,
                marker2Value1,
                marker3Value1,
              ],
              barGap: "0%",
            },
            {
              name: "等位基因2",
              type: "bar",
              data: [
                0,
                0,
                marker6Value2,
                marker4Value2,
                marker7Value2,
                marker1Value2,
                marker5Value2,
                marker8Value2,
                marker2Value2,
                marker3Value2,
              ],
              barGap: "0%",
            },
            {
              name: "等位基因3",
              type: "bar",
              data: [0, 0, 0, marker4Value3, 0, 0, 0, 0, 0, 0],
              barGap: "0%",
             
            },
            
          ],
        };

        /* 使用刚指定的配置项和数据显示图表*/
        myChart.setOption(option1);
      }
    <\/script>`
    
               }else{
                var pictureHtml =""
                var pagingTable=""
                var pagingEnd = ""
                var pictureScript=""
                var echartsPath="" 
               }
               //根据选择的字体进行渲染
               if (font_status == 1) {
                    var changeFont = path.join(__dirname, '../MiSans-Normal.ttf')
                    var changeFont1 = changeFont.replace(/\\/g, "/")
                    console.log(changeFont1)
                    var changeFont2 = 'url(' + changeFont1 + ')'
                    var currentFont = `@font-face{
                            font-family:"MiSans-Normal";
                            src:${changeFont2};
                            font-display:swap;
                        }`
                    var lineSpacing = `line-height:23px`
                    var beforeStage = `text-indent:-12.85pt`
                    var fontSetting = 'font-family:"MiSans-Normal"'

                    } else {
                        var defaultFont = path.join(__dirname, '../simsun.ttc')
                        var defaultFont1 = defaultFont.replace(/\\/g, "/")
                        console.log(defaultFont1)
                        var defaultFont2 = 'url(' + defaultFont1 + ')'
                        var currentFont = `@font-face{
                                font-family:"simsun";
                                src:${defaultFont2};
                                font-display:swap;
                            }`
                        var lineSpacing = `line-height:24px`
                        var beforeStage = `text-indent:-16.85pt`
                        var fontSetting = 'font-family:"simsun"'
              }
               // 添加 svg 方框图片替换 input 输入框
               var correctBox = `<svg t="1654332410780" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2963" width="16" height="16" style="vertical-align: middle;">
                            <path d="M832 128H192a64 64 0 0 0-64 64v640a64 64 0 0 0 64 64h640a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64z m-93.71 270.86L466.76 670.4a32 32 0 0 1-45.26 0L285.71 534.6A32 32 0 0 1 331 489.33L444.14 602.5 693 353.61a32 32 0 0 1 45.26 45.25z" p-id="2964" ></path>
                   </svg>`
               var blankBox = `<svg t="1654332611254" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3878" width="16" height="16" style="vertical-align: middle;">
                       <path d="M774 200c27.6 0 50 22.4 50 50v524c0 27.6-22.4 50-50 50H250c-27.6 0-50-22.4-50-50V250c0-27.6 22.4-50 50-50h524m0-72H250c-16.4 0-32.4 3.2-47.5 9.6-14.5 6.1-27.6 14.9-38.8 26.1-11.2 11.2-20 24.2-26.1 38.8-6.4 15.1-9.6 31.1-9.6 47.5v524c0 16.4 3.2 32.4 9.6 47.5 6.1 14.5 14.9 27.6 26.1 38.8 11.2 11.2 24.2 20 38.8 26.1 15.1 6.4 31.1 9.6 47.5 9.6h524c16.4 0 32.4-3.2 47.5-9.6 14.5-6.1 27.6-14.9 38.8-26.1 11.2-11.2 20-24.2 26.1-38.8 6.4-15.1 9.6-31.1 9.6-47.5V250c0-16.4-3.2-32.4-9.6-47.5-6.1-14.5-14.9-27.6-26.1-38.8-11.2-11.2-24.2-20-38.8-26.1-15.1-6.4-31.1-9.6-47.5-9.6z" p-id="3879"></path>
                   </svg>`
               if (reportResult == '未检出目标基因拷贝数异常') {
                   var defaultBox1 = correctBox
                   var defaultBox2 = blankBox
                   var defaultBox3 = blankBox
                   var defaultBox4 = `font-weight:bold`
               } else if (reportResult == 'SMN1基因外显子7杂合型缺失') {
                   var defaultBox1 = blankBox
                   var defaultBox2 = correctBox
                   var defaultBox3 = blankBox
                   var defaultBox5 = `font-weight:bold`
               } else {
                   var defaultBox1 = blankBox
                   var defaultBox2 = blankBox
                   var defaultBox3 = correctBox
                   var defaultBox6 = `font-weight:bold`
               }
               // HTML File Template
               content[index] = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G030Report</title>
    <!-- 引入 echarts.js -->
    <script src='${echartsPath}'><\/script>
    <style>
        /* Style Definitions */
        p.MsoNormal,
        li.MsoNormal,
        div.MsoNormal {
            margin: 0cm;
            text-align: justify;
            text-justify: inter-ideograph;
            font-size: 10.5pt;
            /* font-family: Simsun; */
        }

        p.MsoListParagraph,
        li.MsoListParagraph,
        div.MsoListParagraph {
            margin: 0cm;
            text-align: justify;
            text-justify: inter-ideograph;
            /*text-indent: 21.0pt;*/
            font-size: 10.5pt;
            /* font-family: Simsun; */
        }

        .MsoChpDefault {
            /* font-family: Simsun; */
        }

        td {
            height: 40px;
        }

        /* Page Definitions */
        @page WordSection1 {
            size: 595.3pt 841.9pt;
            margin: 42.45pt 90.0pt 49.525pt 90.0pt;
            layout-grid: 15.6pt;
        }
        ${currentFont}
        body{
            ${fontSetting}
        }
        div.WordSection1 {
            page: WordSection1;
        }
        
        /* List Definitions */
        ol {
            margin-bottom: 0cm;
        }

        ul {
            margin-bottom: 0cm;
        }

        .checkbox:checked::after {
            background: #000;
        }
        .page-header,
        .page-header-space {
            height: 20px;
            font-size: 8.5px;
        }

        .page-footer,
        .page-footer-space {
            height: auto;
            text-align: center;
            font-size: 8.5px;
        }

        .page-footer {
            position: fixed;
            bottom: 0mm;
            /* width: 100%; */
            /* border-top: 1px solid black; */
            /* for demo */
            /* background: yellow; */
            /* for demo */
        }

        .page-header {
            position: fixed;
            top: 0mm;
            width: 100%;
            /*  border-bottom: 1px solid black;  for demo */
            /* background: yellow; */
            /* for demo */
        }

        /* 文字阴影宋体打印加粗解决方案 */
        .fontBolder {
            text-shadow: 0.15pt 0px 0px black, 0.25pt 0px 0px black, 0.35pt 0px 0px black, -0.25pt 0px 0px black, 0px 0.25pt 0px black, 0px -0.25pt 0px black;
        }

        @media print {
            body {
                margin: 0;
            }
        }
        #mainContent{
            border: 1px solid windowtext;
        }
        /* table tr td{ border-top:1px solid windowtext; } table{ border:1px solid windowtext; border-top-width:0px; }  */
        /* table{ border-collapse:collapse; } table tr{ border:1px solid windowtext; }  */
    </style>
</head>
<body lang=ZH-CN style='word-wrap:break-word;text-justify-trim:punctuation;text-align: center;'>

    <div class=WordSection1 style='layout-grid:15.6pt;margin-top: 30px;'>
        <table cellspacing=0 cellpadding=0 width=556
            style='width:416.7pt;border-collapse:collapse;border:none;margin: auto;text-align: center'>
            <tr>
                <td class="page-header" style="text-align: left;width: 416.7pt;border-bottom: solid windowtext 1pt;">
                    ${sampleLineData[index][12]}
                    <!-- <hr style="width:416.7pt"> -->
                </td>

            </tr>
        </table>
        <table cellspacing=0 cellpadding=0 width=556
            style='width:416.7pt;border-collapse:collapse;margin: auto;text-align: center'>
            <tr>
                <td class="page-footer" style="width:416.7pt;text-align: right">
                    检验结果仅对送检样本负责
                </td>
            </tr>

        </table>
        <p class=MsoNormal align=center style='text-align:center;layout-grid-mode:char;margin: 35px 0 35px 0'><b><span
                    lang=utf-8 style='font-size:14.0pt;'>运动神经元存活基因拷贝数检验报告单</b></p>

        <table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0 width=556 id="mainContent"
            style='width:416.7pt;margin: auto;border-collapse:collapse;'>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>门诊号</b></p>
                </td>
                <td width=183 colspan=7 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][3]}</span>
                    </p>
                </td>
                <td width=73  colspan=4 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center'><b>住院号</b></p>
                </td>
                <td width=110 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][4]}</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoNormal style='text-align:center'><b>姓名</b></p>
                </td>
                <td width=113 colspan=3 style='width:85.0pt;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoNormal align=left style="text-align: left;">
                        <span>
                            ${sampleLineData[index][1]}
                        </span>
                    </p>
                </td>
                <td width=76 style='width:2.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoNormal align=center style='text-align:center'><b>性别</b></p>
                </td>
                <td width=113  colspan=3 style='width:3.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoNormal align=left style='text-align:left'><span>${sampleLineData[index][2]}</span></p>
                </td>
                <td width=73 colspan=4 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoNormal align=center style='text-align:center'><b>手机号</b></p>
                </td>
                <td width=110 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoNormal align=left style='text-align:left'><span>${sampleLineData[index][5]}</span></p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>送检科室</b></p>
                </td>
                <td width=339 colspan=7 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][6]}</span>
                    </p>
                </td>
                <td width=73  colspan=4 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;white-space: nowrap;'><b>送检医生</b></p>
                </td>
                <td width=110 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][7]}</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>样本类型</b></p>
                </td>
                <td width=183 colspan=7 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][13]}</span>
                    </p>
                </td>
                <td width=73  colspan=4 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;white-space: nowrap;'><b>采样日期</b></p>
                </td>
                <td width=110 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][9]}</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>简要病史</b></p>
                </td>
                <td width=339 colspan=12 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][8]}</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>检验方法</b></p>
                </td>
                <td width=339 colspan=12 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:center'>
                        <span >荧光&thinsp;PCR-毛细管电泳法</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>目标基因</b></p>
                </td>
                <td width=339 colspan=6 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:center'>
                        <span><i>SMN1</i>&thinsp;外显子&thinsp;7</span>
                    </p>
                </td>
                <td width=73  colspan=6 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center'>
                        <span><i>SMN2</i>&thinsp;外显子&thinsp;7</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>检验结果</b></p>
                </td>
                <td width=339 colspan=6 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:center'>
                        <span>${sampleLineData[index][16]}</span>
                    </p>
                </td>
                <td width=73  colspan=6 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center'>
                        <span>${sampleLineData[index][17]}</span>
                    </p>
                </td>
            </tr>
            ${pictureHtml}
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>检验结论</b></p>
                </td>
                <td width=183 colspan=12 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        ${defaultBox1}
                    <span style="vertical-align: middle;${defaultBox4}" >未检出目标基因拷贝数异常</span>
                    </p>
                    <p class=MsoNormal align=left style='text-align:left'>
                        ${defaultBox2}
                    <span style="vertical-align: middle;${defaultBox5}" ><i>SMN1&thinsp;</i>基因外显子&thinsp;7&thinsp;杂合型缺失</span>
                    </p>
                    <p class=MsoNormal align=left style='text-align:left'>
                        ${defaultBox3}
                    <span style="vertical-align: middle;${defaultBox6}" ><i>SMN1&thinsp;</i>基因外显子&thinsp;7&thinsp;纯合型缺失</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=73  style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center'><b>建议</b></p>
                </td>
                <td width=110 colspan=12 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center'>
                        <span>遗传咨询</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=556 colspan=13 style='width:416.7pt;padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class='MsoNormal' align=center style='text-align:center'><span><b>结果解释</b></span></p>
                </td>
            </tr>
            <tr>
                <td width=556 colspan=13 valign=middle style='width:416.7pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
                    <p class=MsoListParagraph align=justify style='margin-left:23.25pt;${beforeStage};${lineSpacing};'>
                        1. 本次检验仅用于<i>&thinsp;SMN1&thinsp;</i>中最常见的外显子&thinsp;7&thinsp;缺失型携带者的检验，并未覆盖<i>&thinsp;SMN1&thinsp;</i>基因的罕见点突变检测。因此，当检测结果排除受检者为<i>&thinsp;SMN1&thinsp;</i>第&thinsp;7&thinsp;外显子缺失型携带者时，并不能排除受检者是否携带有<i>&thinsp;SMN1&thinsp;</i>基因的罕见点突变。
                    </p>
                    ${pagingTable}
                    <p class=MsoListParagraph align=center style='margin-left:23.25pt;${beforeStage};${lineSpacing}' >2. 当检出<i>&thinsp;SMN1&thinsp;</i>第&thinsp;7&thinsp;外显子为&thinsp;2&thinsp;拷贝时，并不能直接判断&thinsp;2&thinsp;个拷贝的<i>&thinsp;SMN1&thinsp;</i>在染色体上的排布方式，即不能判断出是否为“&thinsp;2+0&thinsp;”携带者型。当怀疑待检样本存在“&thinsp;2+0&thinsp;”时，建议其配偶进行<i>&thinsp;SMN1&thinsp;</i>基因检测。</p>
                    <p class=MsoListParagraph align=center style='margin-left:23.25pt;${beforeStage};${lineSpacing}' >3. 受检者进行过骨髓移植、细胞治疗或接受输血，可能会影响血样检测结果的准确性。</p>
                    <p class=MsoListParagraph align=center style='margin-left:23.25pt;${beforeStage};${lineSpacing}' >4. 该方法检测<i>&thinsp;SMN1&thinsp;</i>基因第&thinsp;7&thinsp;外显子拷贝数时，将以受检者基因组中保守的管家基因为内参。内参基因罕见的突变可能会影响到检测结果的准确性。</p>
                    <p class=MsoListParagraph align=center style='margin-left:23.25pt;${beforeStage};${lineSpacing}' >5. 检验<i>&thinsp;SMN2&thinsp;</i>基因拷贝数通常仅用于对患者临床预后的评估。正常人群中<i>&thinsp;SMN2&thinsp;</i>基因本身就存在拷贝数变异，可能为&thinsp;0、1、2&thinsp;或以上。</p>
                    ${pagingEnd}
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>检验日期</b></p>
                </td>
                <td width=339 colspan=9 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][10]}</span>
                    </p>
                </td>
                <td width=73  colspan=2 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;white-space: nowrap;'><b>报告日期</b></p>
                </td>
                <td width=110 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][11]}</span>
                    </p>
                </td>
            </tr>
            <tr>
                <td width=71 style='width:53.2pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center;'><b>检验者</b></p>
                </td>
                <td width=339 colspan=9 style='width:167.5pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][14]}</span>
                    </p>
                </td>
                <td width=73  colspan=2 style='width:54.4pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=center style='text-align:center'><b>审核者</b></p>
                </td>
                <td width=110 style='width:82.35pt;padding:0cm 5.4pt 0cm 5.4pt;'>
                    <p class=MsoNormal align=left style='text-align:left'>
                        <span>${sampleLineData[index][15]}</span>
                    </p>
                </td>
            </tr>

        </table>
    </div>

</body>
${pictureScript}
</html>`
// write Html File
fs.writeFile(htmlPathAndName[index], content[index], function (err) {
                        if (err) {
                            var notice = "[WARNING] 输入文件 " + sampleFileName + " 处理有误"

                            if (index == htmlPathAndName.length - 1) {
                                mdui.snackbar({
                                    message: notice,
                                    position: "left-top",
                                    timeout: 1000
                                })
                            }
                            log.error("\n" + "当前处理文件名为：" + sampleFileName + "\n错误提示：\n" + err)
                            throw err
                        }
                        var notice = "输入文件 " + sampleFileName + " 处理完成";
                        console.log('File is created successfully.');
                        setTimeout(() => {
                            if (index == htmlPathAndName.length - 1) {
                                mdui.snackbar({
                                    message: notice,
                                    timeout: 1000
                                })
                            }
                        }, 1000)
                        log.info("\n" + "当前处理文件名为：" + sampleFileName + "\n" + "成功生成HTML文件：" + htmlName[index])
                    })
                    var window_to_PDF1 = []
                    // Html File change to PDF File method
                    function afterWrite() {
                        var {BrowserWindow} = require('electron').remote
                        window_to_PDF1[index] = new BrowserWindow({ show: false });//to just open the browser in background
                        window_to_PDF1[index].loadURL(`file://${htmlPathAndName[index].replace(/\\/g, "/")}`); //give the file link you want to display
                        window_to_PDF1[index].webContents.on('did-finish-load', function () {
                            var path = require('path')
                            window_to_PDF1[index].webContents.printToPDF({}).then(data => {
                                fs.writeFile(pdfPathAndName[index], data, (error) => {
                                    if (error)
                                        throw error
                                    var pdfnotice = `Wrote PDF successfully`
                                    if (index == pdfPathAndName.length - 1) {
                                        mdui.snackbar({
                                            message: pdfnotice,
                                            onClosed: function () {
                                                console.log(file_path1[0])
                                                if (file_path1[0].indexOf('#') != -1 || file_path1[0].indexOf('&') != -1 || file_path1[0].indexOf('+') != -1 || file_path1[0].indexOf('=') != -1 || file_path1[0].indexOf('?') != -1 || file_path1[0].indexOf(' ') != -1) {
                                                    mdui.alert('检测到您上传的文件或路径中存在特殊字符串或空格！请及时修改！否者会导致无法生成PDF报告的图片信息！');
                                                }
                                            }
                                        })
                                    }
                                    log.info("\n" + "当前处理文件名为：" + htmlName[index] + "\n" + "成功生成PDF文件：" + pdfName[index])
                                    if (switch_status == 0) {
                                        fs.unlink(htmlPathAndName[index], function (err) {
                                            if (err) {
                                                console.log("An error ocurred updating the file" + err.message);
                                                return;
                                            }
                                            console.log("HTML File successfully deleted");
                                        })
                                    }
                                    window_to_PDF1[index].close()
                                });
                            }).catch(error => {
                                if (index == pdfPathAndName.length - 1) {
                                    mdui.snackbar({
                                        message: error,
                                        position: "left-top",
                                        timeout: 2000
                                    })
                                }

                                log.error(`Failed to write PDF ${pdfPathAndName[index]}`, error)
                            })
                        })
                    }
                    setTimeout(afterWrite, 1000)

            })
      }


      // event: drag file(s) to window
      const holder = document.getElementById("holder");
      holder.ondragover = () => {
        return false;
      };
      holder.ondragleave = holder.ondragend = () => {
        return false;
      };
      holder.ondrop = (e) => {
        e.preventDefault();
        for (let f of e.dataTransfer.files) {
          console.log("File(s) you dragged here: ", f.path);
          // start(f.path, Encoding, sample_status, peak, more, Chinese, order);
          dataAddress.push(f.path)
          dataAddress1 = dataAddress.pop()
          start(
            f.path,
            Encoding,
            sample_status,
            peak,
            Chinese,
            NTC_status,
            ladder_status,
            includePicture
          );
        }
        return false;
      };
      // event: click to open file manager
      const os = require("os");
      let default_path = os.homedir();
      const { dialog } = require("electron").remote;
      const fileManagerBtn = document.getElementById("holder");
      fileManagerBtn.addEventListener("click", showOpenDialogHandler);
      function showOpenDialogHandler() {
        var options = {
          defaultPath: default_path,
          filters: [{ name: "RawData", extensions: ["txt", "csv"] }],
          properties: ["openFile"],
        };
        dialog
          .showOpenDialog(options)
          .then((result) => {
            console.log("Select file" + result.filePaths);
            console.log(result.filePaths);
            dataAddress.push(result.filePaths)
            dataAddress1 = dataAddress.pop()
            if (!result.filePaths[0]) {
              console.log("No file selected");
              mdui.snackbar({ message: "未选择任何文件" });
              return;
            } else {
              // start(
              //   result.filePaths,
              //   Encoding,
              //   sample_status,
              //   peak,
              //   more,
              //   Chinese,
              //   order
              // );
              start(
                result.filePaths,
                Encoding,
                sample_status,
                peak,
                Chinese,
                NTC_status,
                ladder_status,
                includePicture
              );
            }
          })
          .catch((err) => {
            console.log(err);
            console.log("No file selected");
          });
      }
      var uploadSample = document.getElementById("addUploadSample")
      uploadSample.addEventListener("click",showUploadSampleDialog);
      function showUploadSampleDialog(){
        var options= {
          defaultPath:default_path,
          filters:[{name:"RawData",extensions:["xlsx","xls"]}],
          properties:["openFile"]
        }
        dialog.showOpenDialog(options).then((result)=>{
          console.log("Now Select sample file"+result.filePaths)
          if(!result.filePaths[0]){
            console.log("No sample file selected")
            mdui.snackbar({message:"未选择样本文件"})
            return
          }else{
            sampleFileStart(result.filePaths)
          }
        }).catch((err)=>{
          console.log("err",err)
        })
      }
      var tab3 = document.querySelector("#tab3_icon");
      var ipc = require("electron").ipcRenderer;
      tab3.onclick = () => {
        // ipc.send('tab3')
        // var log = require('electron-log');
        // log.transports.console.level = 'silly';
        // var path = require("path")
        // var { remote } = require('electron')
        // var app = remote.app
        // var filepath = path.join(app.getPath("temp"))
        // var filename = "SMNFiler.log"
        // console.log(path.join(filepath, filename))
        // log.transports.file.resolvePath = () => path.join(filepath, filename)
        var content = fs.readFileSync(path.join(filepath, filename));
        var array = content.toString().split("\n");
        var reg1 = RegExp(/warn/);
        var reg2 = RegExp(/info/);
        var reg3 = RegExp(/error/);
        var message = document.getElementById("test");
        message.innerHTML = "";
        for (var i = 0; i < array.length; i++) {
          if (array[i].match(reg1)) {
            array[i] =
              "<p style='color:#FF5722;text-align:center'>" + array[i] + "</p>";
          } else if (array[i].match(reg2)) {
            array[i] =
              "<p style='color:#4CAF50;text-align:center'>" + array[i] + "</p>";
          } else if (array[i].match(reg3)) {
            array[i] =
              "<p style='color:#FF5722;text-align:center'>" + array[i] + "</p>";
          } else {
            array[i] = "<p style='margin:10px'>" + array[i] + "</p>";
          }
          message.innerHTML += array[i].toString();
        }
      };
      const FindInPage = require("electron-find").FindInPage;
      let findInPage = new FindInPage(remote.getCurrentWebContents());
      ipc.on("on-find", (e, args) => {
        findInPage.openFindWindow();
      });
    </script>
    <script type="text/javascript">
      function down() {
        const div = document.getElementById("test");
        console.log(div.scrollHeight);
        div.scrollTop = div.scrollHeight;
        console.log(div.scrollTop);
      }
      function up() {
        const div1 = document.getElementById("test");
        div1.scrollTop = 0;
      }
      function download() {
        var filePath = path.join(filepath, filename);
        var win = remote.getCurrentWindow();
        win.webContents.downloadURL(filePath);
        // Mac 版本
        // win.webContents.downloadURL("file:///"+filePath)
      }
    </script>
    <style>
      body {
        overflow: hidden;
      }

      .uptop {
        margin-bottom: 50px;
      }
      #customer,
      #customer_ntcTest {
        min-width: 154px;
      }
      #customer_ladderTest {
        min-width: 154px;
        text-transform: none;
      }
      .download {
        margin-bottom: 160px;
      }
      .body {
        overflow-x: hidden;
      }

      .panel {
        text-align: center;
        font-size: 16px;
        margin-top: 16px;
      }

      .result1 {
        margin-top: 16px;
        height: 200px;
        overflow-y: auto;
        overflow-x: hidden;
        padding-left: 36px;
        padding-right: 36px;
        transition: all 0.5s;
      }

      .result2 {
        margin-top: 16px;
        height: 200px;
        overflow-y: auto;
        padding-left: 36px;
        padding-right: 36px;
      }

      @media (min-height: 410px) {
        .result2 {
          height: 200px;
        }
      }

      @media (min-height: 460px) {
        .result2 {
          height: 320px;
        }
      }

      @media (min-height: 500px) {
        .result2 {
          height: 360px;
        }
      }

      @media (min-height: 600px) {
        .result2 {
          height: 460px;
        }
      }

      @media (min-height: 700px) {
        .result2 {
          height: 560px;
        }
      }

      @media (min-height: 850px) {
        .result2 {
          height: 710px;
        }
      }

      @media (min-height: 1000px) {
        .result2 {
          height: 860px;
        }
      }
    </style>
  </body>
</html>
